<div class="row">
  <div class="col-md-8">
    <h1><%= @product.name %></h1>
    <p class="lead"><%= @product.description %></p>

    <div class="d-flex align-items-center gap-3 mb-4">
      <h3 class="mb-0"><%= number_to_currency(@product.price, unit: "€") %></h3>
      <span class="badge bg-<%= @product.stock > 0 ? 'success' : 'danger' %>">
        <%= @product.stock > 0 ? "#{@product.stock} en stock" : "Rupture de stock" %>
      </span>
    </div>

    <div class="d-flex gap-2">
      <% if user_signed_in? %>
        <% if @product.stock > 0 %>
          <%= button_to "Ajouter au panier", product_cart_items_path(@product),
              method: :post,
              class: "btn btn-success" %>
        <% end %>

        <% if @product.user == current_user %>
          <%= link_to "Modifier", edit_product_path(@product), class: "btn btn-warning" %>
          <%= button_to "Supprimer", @product,
              method: :delete,
              data: { confirm: "Êtes-vous sûr ?" },
              class: "btn btn-danger" %>
        <% end %>
      <% else %>
        <%= link_to "Connectez-vous pour acheter", new_user_session_path, class: "btn btn-primary" %>
      <% end %>

      <%= link_to "← Retour", products_path, class: "btn btn-secondary" %>
    </div>

    <div class="mt-4 text-muted">
      <small>Ajouté par <%= @product.user.email %></small>
    </div>
  </div>
</div>
